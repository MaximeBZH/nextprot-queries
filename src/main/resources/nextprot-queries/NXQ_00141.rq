#id:NXQ_00141
#title:Human proteins highly expressed in brain and observed in a PDB struture involving a virus protein
#tags:interaction,federated query,PDB,UniProt,expression,tutorial
#acs:NX_P49023,NX_P05161,NX_Q16630
#count:36
#time:2.3

PREFIX up_core:<http://purl.uniprot.org/core/>
PREFIX taxon:<http://purl.uniprot.org/taxonomy/>
PREFIX up_database:<http://purl.uniprot.org/database/>
select distinct ?entry  where {
  {  
SERVICE <http://sparql.uniprot.org/sparql> {
      SELECT distinct ?humanprotein ?viralprotein ?db WHERE { 
        # get human proteins that share a PDB xref with a viral protein (same PDB id)      
        ?humanprotein a up_core:Protein ; up_core:organism taxon:9606 . 
        ?viralprotein a up_core:Protein ; up_core:organism / up_core:scientificName ?orgname.
        filter(contains(?orgname,"virus"))
        ?humanprotein rdfs:seeAlso ?db .
        ?viralprotein rdfs:seeAlso ?db .
        ?db up_core:database up_database:PDB .
      }
    }
  }
  # get human proteins highly expressed in brain according to HPA
  ?entry skos:exactMatch ?humanprotein .
  ?entry :isoform / :highExpression ?expressionprofile .
  ?expressionprofile :term / :childOf cv:TS-0095 .
  ?expressionprofile :evidence / :reference / :provenance db:HPA .
}
